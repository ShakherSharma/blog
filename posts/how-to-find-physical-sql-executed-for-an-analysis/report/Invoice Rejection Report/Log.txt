WITH 
SAWITH0 AS (select T289187.C51468576 as c2,
     T289187.C188930310 as c3,
     T289187.C65819558 as c4,
     T289187.C251972764 as c5,
     T289187.C503712989 as c6,
     T289187.C101846326 as c7,
     T289187.C198364827 as c8,
     T289187.C253030156 as c9,
     T289187.C51067786 as c10,
     T289187.C10223035 as c11,
     T289187.C196097662 as c12,
     T289187.C203825585 as c13,
     T289187.C323161287 as c14,
     T289187.C379200345 as c15,
     T289187.C209448512 as c16,
     T289187.C15439104 as c17,
     T289187.C10764798 as c18
from 
     (SELECT V184988491.CANCELLED_DATE AS C51468576,         V184988491.GL_DATE AS C188930310,         V184988491.INVOICE_DATE AS C65819558,         V184988491.DESCRIPTION AS C251972764,         V184988491.INVOICE_NUM AS C503712989,         V184988491.INVOICE_RECEIVED_DATE AS C101846326,         V527471652.DISPLAYED_FIELD AS C198364827,         V184988491.TRANS_DISPLAY_NAME_1 AS C253030156,         V220364535.NAME AS C51067786,         V498378102.NAME496 AS C10223035,         V286822520.NAME AS C196097662,         V448314251.PARTY_NAME1 AS C203825585,         V448314251.SEGMENT1 AS C323161287,         V220364535.ORGANIZATION_ID1 AS C379200345,         V286822520.LEGAL_ENTITY_ID AS C209448512,         V498378102.LEDGER_ID AS C15439104,         V184988491.CANCELLED_AMOUNT AS C10764798,         V184988491.RESPONSE AS C270868639,         V184988491.INVOICE_ID AS PKA_InvoiceId0,         V184988491.APPROVAL_HISTORY_ID AS PKA_InvAprvlHistAllApprovalHi0,         V448314251.VENDOR_ID557 AS PKA_VendorId0,         V448314251.PARTY_ID824 AS PKA_PartyPartyId0,         V220364535.EFFECTIVE_START_DATE651 AS PKA_BusinessUnitDateFrom0,         V220364535.EFFECTIVE_END_DATE8 AS PKA_BusinessUnitDateTo0,         V220364535.ORGANIZATION_ID AS PKA_OrganizationUnitTranslati0,         V220364535.EFFECTIVE_START_DATE AS PKA_OrganizationUnitTranslati1,         V220364535.EFFECTIVE_END_DATE AS PKA_OrganizationUnitTranslati2,         V220364535.LANGUAGE AS PKA_OrganizationUnitTranslati3,         V527471652.LOOKUP_TYPE AS PKA_LookupType0,         V527471652.LOOKUP_CODE AS PKA_LookupCode0 FROM (SELECT InvoiceHeader.CANCELLED_AMOUNT,         InvoiceHeader.CANCELLED_DATE,         InvoiceHeader.DESCRIPTION,         InvoiceHeader.GL_DATE,         InvoiceHeader.INVOICE_DATE,         InvoiceHeader.INVOICE_ID,         InvoiceHeader.INVOICE_NUM,         InvoiceHeader.INVOICE_RECEIVED_DATE,         InvoiceHeader.INVOICE_TYPE_LOOKUP_CODE,         InvoiceHeader.LEGAL_ENTITY_ID,         InvoiceHeader.ORG_ID,         InvoiceHeader.SET_OF_BOOKS_ID,         InvoiceHeader.VENDOR_ID,         InvAprvlHistAll.RESPONSE,         InvAprvlHistAll.APPROVER_ID,         InvAprvlHistAll.APPROVAL_HISTORY_ID,         AprvlPersonName.DISPLAY_NAME,         (NVL(AprvlPersonName.DISPLAY_NAME,InvAprvlHistAll.APPROVER_ID)) AS TRANS_DISPLAY_NAME_1 FROM AP_INVOICES_ALL InvoiceHeader, FUN_ALL_BUSINESS_UNITS_V BusinessUnit, AP_INV_APRVL_HIST_ALL InvAprvlHistAll, PER_USERS UserPEO, PER_PERSON_NAMES_F_V AprvlPersonName WHERE (InvoiceHeader.ORG_ID = BusinessUnit.BU_ID AND InvoiceHeader.INVOICE_ID = InvAprvlHistAll.INVOICE_ID(+) AND (-1) = (Nvl(InvAprvlHistAll.LINE_NUMBER, -1)) AND ('DOCUMENTAPPROVAL') = InvAprvlHistAll.HISTORY_TYPE(+) AND (Upper(InvAprvlHistAll.APPROVER_ID)) = UserPEO.USERNAME(+) AND UserPEO.PERSON_ID = AprvlPersonName.PERSON_ID(+) AND ( DATE'2018-05-26'  BETWEEN AprvlPersonName.EFFECTIVE_START_DATE(+) AND AprvlPersonName.EFFECTIVE_END_DATE(+))) AND (( EXISTS (SELECT NULL FROM fnd_grants gnt WHERE exists (SELECT /*+ index(fnd_session_role_sets FND_SESSION_ROLE_SETS_U1) no_unnest */ null FROM fnd_session_role_sets WHERE session_role_set_key = fnd_global.session_role_set_key and role_guid = gnt.grantee_key UNION ALL SELECT fnd_global.user_guid AS path FROM dual WHERE fnd_global.user_guid = gnt.grantee_key)  AND exists (select /*+ no_unnest */ null from fnd_compiled_menu_functions cmf where cmf.function_id = 300000000010896 and cmf.menu_id = gnt.menu_id)  AND gnt.object_id = 300000000009209 AND gnt.grant_type = 'ALLOW' AND gnt.instance_type = 'SET' AND gnt.start_date <= SYSDATE and (gnt.end_date is null or gnt.end_date >= sysdate)  AND (gnt.instance_set_id = 300000012926005 AND  BusinessUnit.BU_ID IN
(SELECT org1.pay_bu_id
   FROM fun_interco_organizations org1, FUN_USER_ROLE_DATA_ASGNMNTS urd1
  WHERE urd1.USER_GUID = FND_GLOBAL.USER_GUID AND urd1.ROLE_NAME = GNT.ROLE_NAME AND urd1.ACTIVE_FLAG!='N'
    AND TO_CHAR(org1.interco_org_id) = urd1.INTERCO_ORG_ID
  UNION
 SELECT org2.rec_bu_id
   FROM fun_interco_organizations org2, FUN_USER_ROLE_DATA_ASGNMNTS urd2
  WHERE urd2.USER_GUID = FND_GLOBAL.USER_GUID AND urd2.ROLE_NAME = GNT.ROLE_NAME AND urd2.ACTIVE_FLAG!='N'
    AND TO_CHAR(org2.interco_org_id) = urd2.INTERCO_ORG_ID
) )) OR  EXISTS (SELECT NULL FROM fnd_grants gnt WHERE exists (SELECT /*+ index(fnd_session_role_sets FND_SESSION_ROLE_SETS_U1) no_unnest */ null FROM fnd_session_role_sets WHERE session_role_set_key = fnd_global.session_role_set_key and role_guid = gnt.grantee_key UNION ALL SELECT fnd_global.user_guid AS path FROM dual WHERE fnd_global.user_guid = gnt.grantee_key)  AND exists (select /*+ no_unnest */ null from fnd_compiled_menu_functions cmf where cmf.function_id = 300000000010896 and cmf.menu_id = gnt.menu_id)  AND gnt.object_id = 300000000009209 AND gnt.grant_type = 'ALLOW' AND gnt.instance_type = 'SET' AND gnt.start_date <= SYSDATE and (gnt.end_date is null or gnt.end_date >= sysdate)  AND (gnt.instance_set_id = 300000000014034 AND BusinessUnit.BU_ID IN ( SELECT pay_bu_id FROM fun_interco_organizations org1 WHERE to_char(org1.interco_org_id) = GNT.PARAMETER1 UNION SELECT rec_bu_id FROM fun_interco_organizations org2 WHERE to_char(org2.interco_org_id) = GNT.PARAMETER2))) OR  EXISTS (SELECT NULL FROM fnd_grants gnt WHERE exists (SELECT /*+ index(fnd_session_role_sets FND_SESSION_ROLE_SETS_U1) no_unnest */ null FROM fnd_session_role_sets WHERE session_role_set_key = fnd_global.session_role_set_key and role_guid = gnt.grantee_key UNION ALL SELECT fnd_global.user_guid AS path FROM dual WHERE fnd_global.user_guid = gnt.grantee_key)  AND exists (select /*+ no_unnest */ null from fnd_compiled_menu_functions cmf where cmf.function_id = 300000000010896 and cmf.menu_id = gnt.menu_id)  AND gnt.object_id = 300000000009209 AND gnt.grant_type = 'ALLOW' AND gnt.instance_type = 'SET' AND gnt.start_date <= SYSDATE and (gnt.end_date is null or gnt.end_date >= sysdate)  AND (gnt.instance_set_id = 300000000012466 AND BusinessUnit.BU_ID IN (SELECT hr.organization_id bu_id FROM hr_organization_information_x hr, gl_access_set_ledgers asl WHERE hr.org_information_context = 'FUN_BUSINESS_UNIT' AND hr.org_information3 = asl.ledger_id and TO_CHAR(asl.access_set_id) = GNT.PARAMETER1 ))) OR exists (select null from fnd_grants gnt where (GNT.object_id = 300000000009209 AND ( (GNT.grantee_key in ( select /*+ INDEX(fnd_session_role_sets FND_SESSION_ROLE_SETS_U1) */ role_guid as path from fnd_session_role_sets where session_role_set_key = fnd_global.session_role_set_key union all select fnd_global.user_guid as path from dual  ) )  ) AND GNT.menu_id in (select cmf.menu_id from fnd_compiled_menu_functions cmf where cmf.function_id = 300000000010896) AND GNT.grant_type = 'ALLOW' AND GNT.start_date <= sysdate  AND ( GNT.end_date IS NULL  OR GNT.end_date >= sysdate )  AND((GNT.INSTANCE_TYPE = 'INSTANCE') AND (GNT.INSTANCE_PK1_VALUE = TO_CHAR(BusinessUnit.BU_ID)) )))))) V184988491, (SELECT Supplier.SEGMENT1,         Supplier.VENDOR_ID AS VENDOR_ID557,         Party.PARTY_ID AS PARTY_ID824,         Party.PARTY_NAME AS PARTY_NAME1 FROM POZ_SUPPLIERS Supplier, HZ_PARTIES Party WHERE Supplier.PARTY_ID = Party.PARTY_ID) V448314251, (SELECT LegalEntity.LEGAL_ENTITY_ID,         LegalEntity.NAME FROM XLE_ENTITY_PROFILES LegalEntity) V286822520, (SELECT OrganizationUnit.ORGANIZATION_ID AS ORGANIZATION_ID1,         OrganizationUnit.EFFECTIVE_START_DATE AS EFFECTIVE_START_DATE651,         OrganizationUnit.EFFECTIVE_END_DATE AS EFFECTIVE_END_DATE8,         OrganizationInformation.ORG_INFORMATION_ID,         OrganizationUnitTranslation.NAME,         OrganizationUnitTranslation.ORGANIZATION_ID,         OrganizationUnitTranslation.EFFECTIVE_START_DATE,         OrganizationUnitTranslation.EFFECTIVE_END_DATE,         OrganizationUnitTranslation.LANGUAGE FROM HR_ALL_ORGANIZATION_UNITS_F OrganizationUnit, HR_ORGANIZATION_INFORMATION_F OrganizationInformation, HR_ORGANIZATION_UNITS_F_TL OrganizationUnitTranslation WHERE OrganizationUnit.ORGANIZATION_ID = OrganizationInformation.ORGANIZATION_ID AND ('FUN_BUSINESS_UNIT') = OrganizationInformation.ORG_INFORMATION_CONTEXT AND OrganizationUnit.ORGANIZATION_ID = OrganizationUnitTranslation.ORGANIZATION_ID AND OrganizationUnit.EFFECTIVE_START_DATE = OrganizationUnitTranslation.EFFECTIVE_START_DATE AND OrganizationUnit.EFFECTIVE_END_DATE = OrganizationUnitTranslation.EFFECTIVE_END_DATE AND (USERENV('LANG')) = OrganizationUnitTranslation.LANGUAGE AND ( DATE'2018-05-26'  BETWEEN OrganizationUnit.EFFECTIVE_START_DATE AND OrganizationUnit.EFFECTIVE_END_DATE) AND ( DATE'2018-05-26'  BETWEEN OrganizationInformation.EFFECTIVE_START_DATE AND OrganizationInformation.EFFECTIVE_END_DATE) AND ( DATE'2018-05-26'  BETWEEN OrganizationUnitTranslation.EFFECTIVE_START_DATE AND OrganizationUnitTranslation.EFFECTIVE_END_DATE)) V220364535, (SELECT Ledger.LEDGER_ID,         Ledger.NAME AS NAME496 FROM GL_LEDGERS Ledger WHERE  ( (Ledger.OBJECT_TYPE_CODE = 'L' ) ) ) V498378102, (SELECT PayablesLookup.DISPLAYED_FIELD,         PayablesLookup.LOOKUP_CODE,         PayablesLookup.LOOKUP_TYPE FROM AP_LOOKUP_CODES PayablesLookup WHERE  ( (PayablesLookup.LOOKUP_TYPE = 'INVOICE TYPE' ) ) ) V527471652 WHERE V184988491.VENDOR_ID = V448314251.VENDOR_ID557(+) AND V184988491.LEGAL_ENTITY_ID = V286822520.LEGAL_ENTITY_ID(+) AND V184988491.ORG_ID = V220364535.ORGANIZATION_ID1 AND V184988491.SET_OF_BOOKS_ID = V498378102.LEDGER_ID AND V184988491.INVOICE_TYPE_LOOKUP_CODE = V527471652.LOOKUP_CODE(+) AND ( ( NOT ( (V184988491.CANCELLED_DATE IS NULL ) ) ) )) T289187
where  ( T289187.C270868639 in ('ORA_AUTO REJECTED', 'REJECTED') ) ),
SAWITH1 AS (select sum(D1.c18) as c1,
     D1.c2 as c2,
     D1.c3 as c3,
     D1.c4 as c4,
     D1.c5 as c5,
     D1.c6 as c6,
     D1.c7 as c7,
     D1.c8 as c8,
     D1.c9 as c9,
     D1.c10 as c10,
     D1.c11 as c11,
     D1.c12 as c12,
     D1.c13 as c13,
     D1.c14 as c14,
     D1.c15 as c15,
     D1.c16 as c16,
     D1.c17 as c17
from 
     SAWITH0 D1
where  ( D1.c2 is not null ) 
group by D1.c2, D1.c3, D1.c4, D1.c5, D1.c6, D1.c7, D1.c8, D1.c9, D1.c10, D1.c11, D1.c12, D1.c13, D1.c14, D1.c15, D1.c16, D1.c17),
SAWITH2 AS (select 0 as c1,
     D1.c2 as c2,
     D1.c3 as c3,
     D1.c4 as c4,
     D1.c5 as c5,
     D1.c6 as c6,
     D1.c7 as c7,
     D1.c8 as c8,
     D1.c9 as c9,
     D1.c10 as c10,
     D1.c11 as c11,
     D1.c12 as c12,
     D1.c13 as c13,
     D1.c14 as c14,
     D1.c15 as c15,
     D1.c1 as c16,
     D1.c16 as c17,
     D1.c17 as c18
from 
     SAWITH1 D1)
select D1.c1 as c1, D1.c2 as c2, D1.c3 as c3, D1.c4 as c4, D1.c5 as c5, D1.c6 as c6, D1.c7 as c7, D1.c8 as c8, D1.c9 as c9, D1.c10 as c10, D1.c11 as c11, D1.c12 as c12, D1.c13 as c13, D1.c14 as c14, D1.c15 as c15, D1.c16 as c16 from ( select D1.c1 as c1,
     D1.c2 as c2,
     D1.c3 as c3,
     D1.c4 as c4,
     D1.c5 as c5,
     D1.c6 as c6,
     D1.c7 as c7,
     D1.c8 as c8,
     D1.c9 as c9,
     D1.c10 as c10,
     D1.c11 as c11,
     D1.c12 as c12,
     D1.c13 as c13,
     D1.c14 as c14,
     D1.c15 as c15,
     D1.c16 as c16
from 
     SAWITH2 D1
order by c1, c14, c12, c11, c10, c13, c8, c6, c5, c7, c4, c3, c2, c9 ) D1 where rownum <= 75001
